<app-loading [condition]="isLoading"></app-loading>

<app-toast [message]="toast.message"></app-toast>
<!-- asset -->
<div [hidden]="isLoading" class="container">
  <app-page-header [title]="title"></app-page-header>
  <div class="row">
    <div class="col-md-12 col-centered">
      <div class="mat-elevation-z4">
        <mat-list *ngIf="asset" dir="rtl">
            <mat-list-item>{{asset.price}}</mat-list-item>
            <mat-list-item>{{asset.city}}</mat-list-item>
            <mat-list-item>{{asset.neighborhood}}</mat-list-item>
            <mat-list-item>{{asset.street}} {{asset.address_home_number}}</mat-list-item>
            <mat-list-item>{{asset.Rooms_text}} חדרים</mat-list-item>
            <mat-list-item>קומה {{asset.Floor_text}}</mat-list-item>
            <mat-list-item>{{asset.HomeTypeID_text}}</mat-list-item>
        </mat-list>
      </div>
    </div>
  </div>
</div>
<!-- comments -->
<div [hidden]="isLoading" class="container">
  <div class="row">
    <div class="col-md-12 col-centered">
      <div class="mat-elevation-z4">
        <mat-list *ngIf="asset && asset.comments.length != 0" dir="rtl">
          <mat-list-item *ngFor="let comment of asset.comments; let i = index">
              {{ i + 1 }} {{comment.title}} {{comment.message}} 
              <br>{{comment.date | date:'medium'}}
              <button mat-icon-button color="warn" class="btn btn-sm btn-danger" (click)="deleteComment(comment)" [disabled]="!auth.isAdmin && auth.currentUser._id != comment.user._id">
                  <i class="fa fa-trash"></i>
              </button>
          </mat-list-item>
        </mat-list>
      </div>
    </div>
  </div>
</div>
<!-- new comment -->
<div [hidden]="isLoading" class="container">
  <div class="row">
    <div class="col-md-12">
      <div class="mat-elevation-z4">
        <div class="form-wrap">
          <form [formGroup]="commentForm" (ngSubmit)="post()" dir="rtl">
            <div class="input-wrap">
              <mat-form-field>
                <span matPrefix>
                  <i class="prefix fa fa-user"></i>
                </span>
                <input matInput #inputTitle type="text" minlength="2" maxlength="30" name="commentTitle" [formControl]="commentTitle" placeholder=" כותרת">
                <mat-hint align="end">{{inputTitle.value?.length || 0}}/30</mat-hint>
                <mat-error *ngIf="commentTitle.hasError('minlength')">
                  נושא צריך להכיל לפחות 2 תווים
                </mat-error>
                <mat-error *ngIf="commentTitle.hasError('required')">
                  <strong>שדה חובה</strong>
                </mat-error>
              </mat-form-field>
            </div>
            <div class="input-wrap">
              <mat-form-field>
                <span matPrefix>
                  <i class="prefix fa fa-envelope"></i>
                </span>
                <input matInput #inputMessage type="text" minlength="5" maxlength="100" name="commentMessage" [formControl]="commentMessage" placeholder=" תוכן">
                <mat-hint align="end">{{inputMessage.value?.length || 0}}/100</mat-hint>
                <mat-error *ngIf="commentMessage.hasError('minlength')">
                    תוכן צריך להכיל לפחות 5 תווים
                  </mat-error>
                <mat-error *ngIf="commentMessage.hasError('required')">
                  <strong>שדה חובה</strong>
                </mat-error>
              </mat-form-field>
            </div>
            <div class="input-wrap">
              <mat-form-field>
                <span matPrefix>
                  <i class="prefix fa fa-key"></i>
                </span>
                <input matInput type="number" name="commentRate" [formControl]="commentRate" placeholder=" דירוג">
                <mat-error *ngIf="commentRate.hasError('required')">
                  <strong>שדה חובה</strong>
                </mat-error>
              </mat-form-field>
            </div>
            <button mat-raised-button type="submit" [disabled]="!commentForm.valid" color="primary">
              <i class="fa fa-plus"></i>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>